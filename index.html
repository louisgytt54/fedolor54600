<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Calcul des jours de congé payé</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #F8F7EF;
            color: #3E3E47;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            text-align: center;
        }
        header {
            width: 100%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            position: absolute;
            top: 0;
            left: 0;
        }
        header img {
            max-height: 80px;
        }
        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            width: 100%;
            height: 100%;
            display: none; /* Masquer le contenu principal initialement */
        }
        h2, h3 {
            color: #3E3E47;
        }
        form, button {
            margin: 20px 0;
        }
        table {
            width: 50%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #3E3E47;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        label {
            margin-right: 10px;
        }
        input, select, button {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #3E3E47;
            border-radius: 5px;
        }
        button {
            background-color: #db0661;
            color: #F8F7EF;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        button:hover {
            background-color: #3E3E47;
        }
        p {
            font-size: 1.2em;
        }
        #totalDays {
            color: #5e8bbf;
        }
        .animate {
            display: inline-block;
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        .button-animate {
            position: absolute;
            top: 0;
            left: -100%;
            width: 200%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.2);
            transform: skewX(-45deg);
            transition: left 0.5s;
        }
        button:hover .button-animate {
            left: 100%;
        }
        #loginOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(248, 247, 239, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        #loginOverlay p {
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        #accessDenied {
            display: none;
        }
        #mainContent {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        #adminPanel {
            margin-top: 20px;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        #generatedPassword {
            font-weight: bold;
            color: #db0661;
        }
    </style>
    <script>
        // Charger les utilisateurs à partir de localStorage ou utiliser des utilisateurs par défaut
        const users = JSON.parse(localStorage.getItem('users')) || [
            { username: "user1", password: "1234" },
            { username: "user2", password: "2345" },
            { username: "user3", password: "3456" },
            { username: "user4", password: "4567" },
            { username: "user5", password: "5678" },
            { username: "user6", password: "6789" },
            { username: "user7", password: "7890" },
            { username: "user8", password: "8901" },
            { username: "user9", password: "9012" },
            { username: "user10", password: "0123" }
        ];

        // Sauvegarder les utilisateurs dans localStorage
        function saveUsers() {
            localStorage.setItem('users', JSON.stringify(users));
        }

        function calculateDays() {
            const startDate = new Date(document.getElementById("startDate").value);
            const endDate = new Date(document.getElementById("endDate").value);
            const typeArret = document.getElementById("typeArret").value;
            const classification = document.getElementById("classification").value;
            let totalDays = 0;

            const daysInMonthProfessionnelle = classification === "51" ? 4.25 : 3;
            const daysInMonthNonProfessionnelle = 3;

            let currentDate = new Date(startDate);

            if (typeArret === "professionnelle") {
                while (currentDate <= endDate) {
                    let monthStart = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
                    let monthEnd = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);

                    if (currentDate.getMonth() === endDate.getMonth() && currentDate.getFullYear() === endDate.getFullYear()) {
                        totalDays += (endDate.getDate() - currentDate.getDate() + 1) * (daysInMonthProfessionnelle / 30);
                        break;
                    } else {
                        totalDays += (monthEnd.getDate() - currentDate.getDate() + 1) * (daysInMonthProfessionnelle / 30);
                    }

                    currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1);
                }
            } else if (typeArret === "classique") {
                const limitDate = new Date(startDate);
                limitDate.setFullYear(startDate.getFullYear() + 1);
                while (currentDate <= endDate) {
                    if (currentDate > limitDate) break;

                    let monthStart = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
                    let monthEnd = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);

                    if (currentDate.getMonth() === endDate.getMonth() && currentDate.getFullYear() === endDate.getFullYear()) {
                        totalDays += (endDate.getDate() - currentDate.getDate() + 1) * (daysInMonthNonProfessionnelle / 30);
                        break;
                    } else {
                        totalDays += (monthEnd.getDate() - currentDate.getDate() + 1) * (daysInMonthNonProfessionnelle / 30);
                    }

                    currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1);
                }
            }

            document.getElementById("totalDays").innerText = totalDays.toFixed(2) + " jours";
            alert("N'oubliez pas d'ajouter les congés acquis avant et après la maladie au résultat.");
        }

        function verifyLogin() {
            const username = prompt("Veuillez entrer votre nom d'utilisateur:");
            const password = prompt("Veuillez entrer votre mot de passe:");
            const user = users.find(user => user.username === username && user.password === password);

            if (username === "admin" && password === "1234") {
                document.getElementById("adminPanel").style.display = "flex";
                document.getElementById("accessDenied").style.display = "none";
                document.getElementById("mainContent").style.display = "flex";
                document.getElementById("loginOverlay").style.display = "none";
                document.querySelector('main').style.display = 'flex';
            } else if (user) {
                document.getElementById("accessDenied").style.display = "none";
                document.getElementById("mainContent").style.display = "flex";
                document.getElementById("loginOverlay").style.display = "none";
                document.querySelector('main').style.display = 'flex';
            } else {
                alert("Identifiants incorrects, veuillez réessayer.");
                verifyLogin();
            }
        }

        function createAccount() {
            const username = document.getElementById("newUsername").value;
            const password = Math.floor(1000 + Math.random() * 9000).toString();
            if (username) {
                users.push({ username, password });
                saveUsers(); // Sauvegarder les utilisateurs dans localStorage
                document.getElementById("generatedPassword").innerText = `Utilisateur: ${username}, Mot de passe: ${password}`;
            } else {
                alert("Veuillez entrer un nom d'utilisateur.");
            }
        }

        window.onload = function() {
            document.getElementById("loginOverlay").style.display = "flex";
            verifyLogin();
        };
    </script>
</head>
<body>
    <header>
        <img src="Logo_fd-ogec.png" alt="Logo OGEC Lorraine">
    </header>
    <main>
        <div id="accessDenied">
            <h1>Accès non autorisé</h1>
            <p>Fedolor vous indique que vous n'avez pas accès à cette ressource.</p>
        </div>

        <div id="mainContent">
            <h2>Calcul des jours de congé payé</h2>
            <h3>Dates d'arrêt maladie</h3>
            <form>
                <label for="startDate">Date de début :</label>
                <input type="date" id="startDate" name="startDate">
                <br>
                <label for="endDate">Date de fin :</label>
                <input type="date" id="endDate" name="endDate">
                <br>
                <label for="typeArret">Type d'arrêt :</label>
                <select id="typeArret" name="typeArret">
                    <option value="professionnelle">Maladie professionnelle</option>
                    <option value="classique">Maladie classique</option>
                </select>
                <br>
                <label for="classification">Classification (AT/MP) :</label>
                <select id="classification" name="classification">
                    <option value="36">36 jours par an</option>
                    <option value="51">51 jours par an</option>
                </select>
            </form>
            <h3>Calcul final des jours acquis</h3>
            <button type="button" onclick="calculateDays()">Calculer
                <div class="button-animate"></div>
            </button>
            <p>Total général : <span id="totalDays" class="animate"></span></p>
        </div>

        <div id="adminPanel">
            <h3>Créer un nouvel identifiant utilisateur</h3>
            <input type="text" id="newUsername" placeholder="Nom d'utilisateur">
            <button type="button" onclick="createAccount()">Créer un identifiant</button>
            <p id="generatedPassword"></p>
        </div>
    </main>
    <div id="loginOverlay">
        <p>Veuillez vous identifier pour accéder à cette ressource</p>
    </div>
</body>
</html>
